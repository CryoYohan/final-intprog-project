{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { Role } from './_models';\nimport { filter } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./_services\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"./_components/alert.component\";\nfunction AppComponent_nav_1_a_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 17);\n    i0.ɵɵtext(1, \"Employees\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_nav_1_a_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 18);\n    i0.ɵɵtext(1, \"Departments\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_nav_1_a_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 19);\n    i0.ɵɵtext(1, \"Admin\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return {\n    exact: true\n  };\n};\nfunction AppComponent_nav_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nav\", 6)(1, \"div\", 7)(2, \"div\", 8)(3, \"a\", 9);\n    i0.ɵɵtext(4, \"Home\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"a\", 10);\n    i0.ɵɵtext(6, \"Profile\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, AppComponent_nav_1_a_7_Template, 2, 0, \"a\", 11);\n    i0.ɵɵtemplate(8, AppComponent_nav_1_a_8_Template, 2, 0, \"a\", 12);\n    i0.ɵɵtemplate(9, AppComponent_nav_1_a_9_Template, 2, 0, \"a\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 14)(11, \"span\", 15);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"a\", 16);\n    i0.ɵɵlistener(\"click\", function AppComponent_nav_1_Template_a_click_13_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.openLogoutModal());\n    });\n    i0.ɵɵtext(14, \"Logout\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLinkActiveOptions\", i0.ɵɵpureFunction0(5, _c0));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.account.role === ctx_r0.Role.Admin || ctx_r0.account.role === ctx_r0.Role.Moderator);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.account.role === ctx_r0.Role.Admin);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.account.role === ctx_r0.Role.Admin);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" Welcome, \", ctx_r0.account.firstName || \"User\", \"! \");\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    \"d-block\": a0\n  };\n};\nfunction AppComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"div\", 21)(2, \"div\", 22)(3, \"div\", 23)(4, \"h5\", 24);\n    i0.ɵɵtext(5, \"Confirm Logout\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.closeLogoutModal());\n    });\n    i0.ɵɵelementStart(7, \"span\", 26);\n    i0.ɵɵtext(8, \"\\u00D7\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 27)(10, \"p\");\n    i0.ɵɵtext(11, \"Are you sure you want to logout?\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 28)(13, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.closeLogoutModal());\n    });\n    i0.ɵɵtext(14, \"Cancel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_7_Template_button_click_15_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.logout());\n    });\n    i0.ɵɵtext(16, \"Logout\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(1, _c1, ctx_r1.showLogoutModal));\n  }\n}\nfunction AppComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 31);\n  }\n}\nconst _c2 = function (a0) {\n  return {\n    \"bg-light\": a0\n  };\n};\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(accountService, router) {\n      this.accountService = accountService;\n      this.router = router;\n      this.Role = Role;\n      this.showLogoutModal = false;\n      // Initialize account from service\n      this.account = this.accountService.accountValue;\n      console.log('App: Initial account state:', this.account);\n    }\n    ngOnInit() {\n      // Subscribe to account changes\n      this.accountSubscription = this.accountService.account.subscribe({\n        next: account => {\n          console.log('App: Account state changed:', account);\n          this.account = account;\n          // If account exists and we're on the login page, redirect to home\n          if (account && this.router.url.includes('/account/login')) {\n            console.log('App: Redirecting to home page');\n            this.router.navigate(['/']);\n          }\n        },\n        error: error => {\n          console.error('App: Error in account subscription:', error);\n        }\n      });\n      // Subscribe to router events to handle navigation\n      this.routerSubscription = this.router.events.pipe(filter(event => event instanceof NavigationEnd)).subscribe(() => {\n        // Check if we should redirect to home when logged in\n        if (this.account && this.router.url.includes('/account/login')) {\n          console.log('App: Navigation - Redirecting logged in user from login page');\n          this.router.navigate(['/']);\n        }\n        // Check if we need to redirect to login when not logged in\n        if (!this.account && !this.router.url.includes('/account/')) {\n          console.log('App: Navigation - Redirecting non-logged in user to login');\n          this.router.navigate(['/account/login']);\n        }\n      });\n    }\n    ngOnDestroy() {\n      // Clean up subscriptions\n      if (this.accountSubscription) {\n        this.accountSubscription.unsubscribe();\n      }\n      if (this.routerSubscription) {\n        this.routerSubscription.unsubscribe();\n      }\n    }\n    openLogoutModal() {\n      this.showLogoutModal = true;\n    }\n    closeLogoutModal() {\n      this.showLogoutModal = false;\n    }\n    logout() {\n      this.accountService.clearAccountData();\n      this.closeLogoutModal();\n    }\n  }\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.AccountService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 9,\n    vars: 6,\n    consts: [[1, \"app-container\", 3, \"ngClass\"], [\"class\", \"navbar navbar-expand navbar-dark bg-dark\", 4, \"ngIf\"], [\"name\", \"subnav\"], [1, \"container\", \"mt-3\"], [\"class\", \"modal fade show\", \"tabindex\", \"-1\", \"role\", \"dialog\", 3, \"ngClass\", 4, \"ngIf\"], [\"class\", \"modal-backdrop fade show\", 4, \"ngIf\"], [1, \"navbar\", \"navbar-expand\", \"navbar-dark\", \"bg-dark\"], [1, \"container\"], [1, \"navbar-nav\", \"me-auto\"], [\"routerLink\", \"/\", \"routerLinkActive\", \"active\", 1, \"nav-item\", \"nav-link\", 3, \"routerLinkActiveOptions\"], [\"routerLink\", \"/profile\", \"routerLinkActive\", \"active\", 1, \"nav-item\", \"nav-link\"], [\"routerLink\", \"/employees\", \"routerLinkActive\", \"active\", \"class\", \"nav-item nav-link\", 4, \"ngIf\"], [\"routerLink\", \"/departments\", \"routerLinkActive\", \"active\", \"class\", \"nav-item nav-link\", 4, \"ngIf\"], [\"routerLink\", \"/admin\", \"routerLinkActive\", \"active\", \"class\", \"nav-item nav-link\", 4, \"ngIf\"], [1, \"navbar-nav\"], [1, \"nav-item\", \"nav-link\", \"text-light\", \"me-3\"], [1, \"nav-item\", \"nav-link\", 2, \"cursor\", \"pointer\", 3, \"click\"], [\"routerLink\", \"/employees\", \"routerLinkActive\", \"active\", 1, \"nav-item\", \"nav-link\"], [\"routerLink\", \"/departments\", \"routerLinkActive\", \"active\", 1, \"nav-item\", \"nav-link\"], [\"routerLink\", \"/admin\", \"routerLinkActive\", \"active\", 1, \"nav-item\", \"nav-link\"], [\"tabindex\", \"-1\", \"role\", \"dialog\", 1, \"modal\", \"fade\", \"show\", 3, \"ngClass\"], [\"role\", \"document\", 1, \"modal-dialog\", \"modal-dialog-centered\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"modal-backdrop\", \"fade\", \"show\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, AppComponent_nav_1_Template, 15, 6, \"nav\", 1);\n        i0.ɵɵelement(2, \"router-outlet\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelement(4, \"alert\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵelement(6, \"router-outlet\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(7, AppComponent_div_7_Template, 17, 3, \"div\", 4);\n        i0.ɵɵtemplate(8, AppComponent_div_8_Template, 1, 0, \"div\", 5);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(4, _c2, ctx.account));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.account);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.showLogoutModal);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showLogoutModal);\n      }\n    },\n    dependencies: [i3.NgClass, i3.NgIf, i2.RouterOutlet, i2.RouterLink, i2.RouterLinkActive, i4.AlertComponent],\n    styles: [\".app-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column}.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa}.navbar[_ngcontent-%COMP%]{padding:.75rem 0;margin-bottom:0;box-shadow:0 2px 4px #0000001a}.navbar-nav[_ngcontent-%COMP%]{display:flex;align-items:center}.nav-item[_ngcontent-%COMP%]{margin-right:1rem}.nav-link[_ngcontent-%COMP%]{color:#ffffffd9;transition:color .2s ease-in-out;padding:.5rem 1rem}.nav-link[_ngcontent-%COMP%]:hover{color:#fff}.nav-link.active[_ngcontent-%COMP%]{color:#fff;font-weight:500;position:relative}.nav-link.active[_ngcontent-%COMP%]:after{content:\\\"\\\";position:absolute;bottom:-2px;left:1rem;right:1rem;height:2px;background-color:#fff}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:1040}.modal[_ngcontent-%COMP%]{z-index:1050}.modal-dialog[_ngcontent-%COMP%]{margin:1.75rem auto;max-width:500px}.modal-content[_ngcontent-%COMP%]{border-radius:.5rem;border:none;box-shadow:0 .5rem 1rem #00000026}.modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:1rem 1.5rem}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;padding:1rem 1.5rem}alert[_ngcontent-%COMP%]{display:block;margin-bottom:1rem}.container[_ngcontent-%COMP%]{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto;max-width:1140px}\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}